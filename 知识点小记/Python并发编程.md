# Python并发编程

## 前置概念

1.并发：在一个时间段以内，有几个程序在，**同一个CPU上运行**，但是在同一个时刻只有一个程序运行

2.并行：**在同一时刻，在多个CPU上**，同时运行多个独立的程序

3.同步：（注意同步和异步只是针对于I/O操作来讲的）值调用IO操作时，必须等待IO操作完成后才开始新的的调用方式。

4.异步：指调用IO操作时，不必等待IO操作完成就开始新的的调用方式。

5.阻塞：指调用函数的时候，当前线程被挂起。

6.非阻塞：指调用函数的时候，当前线程不会被挂起，而是立即返回。

7.IO多路复用：sllect， poll， epoll都是IO多路复用的机制。IO多路复用就是通过这样一种机制：一个进程可以监听多个描述符，一旦某个描述符就绪（一般是读就绪和写就绪），能够通知程序进行相应的操作。但select，poll，epoll本质上都是同步IO，因为他们都需要在读写事件就绪后自己负责进行读写（即将数据从内核空间拷贝到应用缓存）。也就是说这个读写过程是阻塞的。而异步IO则无需自己负责读写，异步IO的实现会负责把数据从内核拷贝到用户空间。

## 并发的简介

### 引入并发原因

引入并发可以大幅度提高程序的运行速度

### 程序提速的方法

1.单线程运行：不加改造的程序

2.多线程并发：threading

3.多CPU并行：multiprocessing

4.多机器并行：hadoop/hive/spark

### python对并发的支持

1.多线程：threading,利用CPU和IO可以同时执行的原理，让CPU不必等待IO完成

2.多进程：multiprocessing,利用多核CPU实现并行

3.异步IO:asyncio，在单线程利用CPU和IO同时执行的原理，实现函数异步执行

4.在多线程多进程时加入LOCK资源加锁，防止冲突访问

5.使用Queue实现进程/线程之间的数据通信，实现生产者-消费者模式

6.使用线程池与进程池，简化线程进程之间的任务提交，等待借宿，获取结果

7.使用subprocess启动外部exe程序，并进行输出输入交互

## Python并发编程的三种方式

### 密集型计算

#### CPU密集型计算

指io可以很快完成，cpu需要大量计算，cpu占用率相当高

#### IO密集型计算

cpu大部分在等待I/O读写，CPU占用率低



